import{r as i,j as e}from"./index-CYVxox-v.js";import{a as x}from"./add-image-CJwnxBQ3.js";const u="_expenses_dj8m7_1",p="_expenses_container_dj8m7_21",j="_addBtn_dj8m7_21",_="_new_expense_container_dj8m7_81",m="_add_income_btn_dj8m7_123",g="_cancel_btn_dj8m7_129",v="_add_form_dj8m7_135",b="_no_expenses_dj8m7_167",a={expenses:u,expenses_container:p,addBtn:j,new_expense_container:_,add_income_btn:m,cancel_btn:g,add_form:v,no_expenses:b};function f({user:r,setSectionShowed:t,setExpenses:o}){const[n,l]=i.useState({date:new Date().toISOString().split("T")[0],amount:"",currency:"Soles",purpose:"Housing rent"});async function d(){if(n.amount===""){alert("Amount can't be null");return}try{if(!(await fetch(`https://fca-api-5k3h.onrender.com/users/${r.id}/expenses`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...n,amount:Number(parseFloat(n.amount).toFixed(2))})})).ok)throw new Error("Error al agregar el ingreso");fetch("https://fca-api-5k3h.onrender.com/users").then(c=>c.json()).then(c=>o(c[c.findIndex(h=>h.username===r.username)].expenses)).then(()=>t("expenses_container"))}catch(s){console.error("Error al agregar el nuevo ingreso:",s)}}return e.jsxs("div",{className:a.new_expense_container,children:[e.jsx("h2",{children:"Add new expense"}),e.jsxs("form",{className:a.add_form,children:[e.jsxs("section",{children:[e.jsx("label",{children:"Date:"}),e.jsx("input",{type:"date",value:n.date,onChange:s=>l({...n,date:s.target.value})})]}),e.jsxs("section",{children:[e.jsx("label",{children:"Amount:"}),e.jsx("input",{type:"number",placeholder:"Enter amount...",value:n.amount,onChange:s=>l({...n,amount:s.target.value})})]}),e.jsxs("section",{children:[e.jsx("label",{children:"Currency:"}),e.jsxs("select",{value:n.currency,onChange:s=>l({...n,currency:s.target.value}),children:[e.jsx("option",{value:"Soles",children:"Soles"}),e.jsx("option",{value:"USD",disabled:!0,children:"USD"})]})]}),e.jsxs("section",{children:[e.jsx("label",{children:"Purpose:"}),e.jsxs("select",{value:n.purpose,onChange:s=>l({...n,purpose:s.target.value}),children:[e.jsx("option",{value:"Housing rent",children:"Housing rent"}),e.jsx("option",{value:"Food",children:"Food"}),e.jsx("option",{value:"Investments",children:"Investments"}),e.jsx("option",{value:"Clothes",children:"Clothes"}),e.jsx("option",{value:"Phone plan",children:"Phone plan"}),e.jsx("option",{value:"Electric bill",children:"Electric bill"}),e.jsx("option",{value:"Other bills",children:"Other bills"}),e.jsx("option",{value:"Health",children:"Health"}),e.jsx("option",{value:"Fares",children:"Fares"}),e.jsx("option",{value:"Others",children:"Others"})]})]})]}),e.jsx("button",{className:a.add_income_btn,onClick:d,children:"Add"}),e.jsx("button",{className:a.cancel_btn,onClick:()=>t("expenses_container"),children:"Cancel"})]})}function y({expenses:r,setSectionShowed:t}){return e.jsxs("main",{className:a.expenses_container,children:[e.jsx("img",{className:a.addBtn,onClick:()=>t(""),src:x,alt:""}),r&&r.length!==0?e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Purpose"})]})}),e.jsx("tbody",{children:r.map((o,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:o.date}),e.jsx("td",{style:{textAlign:"right",fontWeight:"bold"},children:parseFloat(o.amount).toFixed(2)}),e.jsx("td",{children:o.currency}),e.jsx("td",{children:o.purpose})]},n))})]}):e.jsxs("div",{className:a.no_expenses,children:[e.jsx("h1",{children:e.jsx("em",{children:"No expenses to show"})}),e.jsx("h2",{children:e.jsxs("em",{children:['Tap "',e.jsx("span",{children:"+"}),'" icon to add an expense']})})]})]})}function E({user:r,expenses:t,setExpenses:o}){const[n,l]=i.useState("expenses_container"),[d,s]=i.useState(!0);return i.useEffect(()=>{t!==null&&s(!1)},[t]),e.jsx(e.Fragment,{children:d?e.jsx("h1",{children:"Loading..."}):t?e.jsx("div",{className:a.expenses,style:{overflowY:t.length>16&&n=="expenses_container"?"scroll":"hidden"},children:n=="expenses_container"?e.jsx(y,{expenses:t,setSectionShowed:l}):e.jsx(f,{user:r,setSectionShowed:l,setExpenses:o})}):null})}export{E as default};
