import{r as m,j as e}from"./index-BNV0-wWS.js";const y="_goals_w7dkz_1",k="_add_goal_btn_w7dkz_21",E="_goals_container_w7dkz_53",b="_goals_list_w7dkz_77",N="_goals_name_w7dkz_129",C="_no_goals_w7dkz_171",v="_create_goal_w7dkz_199",S="_cancelBtn_w7dkz_263",r={goals:y,add_goal_btn:k,goals_container:E,goals_list:b,goals_name:N,no_goals:C,create_goal:v,cancelBtn:S};function T({user:a,goals:s,setGoals:i,achievedGoals:t,setAchievedGoals:g,sectionShowed:_,setSectionShowed:l}){const[p,c]=m.useState(!0);m.useEffect(()=>{s!==null&&t!==null&&c(!1)},[s,t]);const j=async(o,n)=>{try{if(!(await fetch(`http://localhost:5000/users/${a.id}/achieved_goals`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw new Error("Error adding achieved goal");if(!(await fetch(`http://localhost:5000/users/${a.id}/goals/${n}`,{method:"DELETE"})).ok)throw new Error("Error deleting goal");i(h=>{const u=[...h];return u.splice(n,1),u}),g(h=>[...h,o])}catch(d){console.error(d)}},x=async(o,n)=>{try{if(!(await fetch(`http://localhost:5000/users/${a.id}/goals`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw new Error("Error returning goal");if(!(await fetch(`http://localhost:5000/users/${a.id}/achieved_goals/${n}`,{method:"DELETE"})).ok)throw new Error("Error deleting goal");g(h=>{const u=[...h];return u.splice(n,1),u}),i(h=>[...h,o])}catch(d){console.error(d)}};async function w(o){if(!(await fetch(`https://fca-api-5k3h.onrender.com/users/${a.id}/goals/${o}`,{method:"DELETE"})).ok)throw new Error("Error deleting goal");i(d=>{const f=[...d];return f.splice(o,1),f})}return e.jsxs("main",{className:r.goals_content,children:[e.jsx("button",{onClick:()=>l(""),className:r.add_goal_btn,children:"Add a goal"}),p?e.jsx("h1",{children:"Loading..."}):s.length>0||t.length>0?e.jsxs("ul",{className:r.goals_container,style:{overflowY:s.length+t.length>6&&_==="goals_container"?"scroll":"hidden",justifyContent:s.length+t.length<7?"center":"flex-start"},children:[t.map((o,n)=>e.jsxs("li",{className:r.goals_list,style:{textDecoration:"line-through",border:"2px solid #00FF00"},children:[e.jsx("p",{className:r.goals_name,children:o}),e.jsx("input",{type:"checkbox",checked:!0,onChange:()=>x(o,n)})]},n)),s.map((o,n)=>e.jsxs("li",{className:r.goals_list,children:[e.jsx("p",{className:r.goals_name,children:o}),e.jsx("input",{type:"checkbox",checked:!1,onChange:()=>j(o,n)}),e.jsx("button",{style:{position:"relative",top:-44,left:405},onClick:()=>w(n),children:"x"})]},n))]}):e.jsxs("div",{className:r.no_goals,children:[e.jsx("h1",{children:e.jsx("em",{children:"You don't have any goals yet"})}),e.jsx("h2",{children:e.jsx("em",{children:"Try adding one!"})})]})]})}function $({user:a,setSectionShowed:s,setGoals:i}){const[t,g]=m.useState("");async function _(l){if(l.preventDefault(),t===""){alert("Goal field can't be empty");return}try{const p=await fetch(`https://fca-api-5k3h.onrender.com/users/${a.id}/goals`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(p.ok)fetch("https://fca-api-5k3h.onrender.com/users").then(c=>c.json()).then(c=>{i(c[c.findIndex(j=>j.username===a.username)].goals)}).then(()=>s("goals_container"));else{const c=await p.json();alert(c.message);return}}catch(p){console.error("Error al agregar la nueva meta:",p),alert("Ocurrió un error al agregar la nueva meta. Inténtalo de nuevo.")}}return e.jsxs("div",{className:r.create_goal,children:[e.jsx("h1",{children:"Write a new goal"}),e.jsx("h3",{children:"If you write your goals, you are more close to achieve it!"}),e.jsx("hr",{}),e.jsxs("form",{children:[e.jsx("input",{type:"text",value:t,onChange:l=>g(l.target.value),placeholder:"Write a goal..."})," ",e.jsx("br",{}),e.jsx("button",{onClick:l=>_(l),children:"Add"}),e.jsx("button",{className:r.cancelBtn,onClick:()=>s("goals_container"),children:"Cancel"})]})]})}function O({user:a,goals:s,achievedGoals:i,setGoals:t,setAchievedGoals:g}){const[_,l]=m.useState("goals_container");return e.jsx("div",{className:r.goals,children:_==="goals_container"?e.jsx(T,{user:a,goals:s,setGoals:t,sectionShowed:_,setSectionShowed:l,achievedGoals:i,setAchievedGoals:g}):e.jsx($,{user:a,setSectionShowed:l,setGoals:t})})}export{O as default};
